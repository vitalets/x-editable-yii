/*! X-editable - v1.4.4 
* In-place editing with Twitter Bootstrap, jQuery UI or pure jQuery
* http://github.com/vitalets/x-editable
* Copyright (c) 2013 Vitaliy Potapov; Licensed MIT */
(function($){var EditableForm=function(div,options){this.options=$.extend({},$.fn.editableform.defaults,options);this.$div=$(div);if(!this.options.scope){this.options.scope=this;}};EditableForm.prototype={constructor:EditableForm,initInput:function(){this.input=this.options.input;this.value=this.input.str2value(this.options.value);},initTemplate:function(){this.$form=$($.fn.editableform.template);},initButtons:function(){this.$form.find(".editable-buttons").append($.fn.editableform.buttons);},render:function(){this.$loading=$($.fn.editableform.loading);this.$div.empty().append(this.$loading);this.initTemplate();if(this.options.showbuttons){this.initButtons();}else{this.$form.find(".editable-buttons").remove();}this.showLoading();this.$div.triggerHandler("rendering");this.initInput();this.input.prerender();this.$form.find("div.editable-input").append(this.input.$tpl);this.$div.append(this.$form);$.when(this.input.render()).then($.proxy(function(){if(!this.options.showbuttons){this.input.autosubmit();}this.$form.find(".editable-cancel").click($.proxy(this.cancel,this));if(this.input.error){this.error(this.input.error);this.$form.find(".editable-submit").attr("disabled",true);this.input.$input.attr("disabled",true);this.$form.submit(function(e){e.preventDefault();});}else{this.error(false);this.input.$input.removeAttr("disabled");this.$form.find(".editable-submit").removeAttr("disabled");this.input.value2input(this.value);this.$form.submit($.proxy(this.submit,this));}this.$div.triggerHandler("rendered");this.showForm();if(this.input.postrender){this.input.postrender();}},this));},cancel:function(){this.$div.triggerHandler("cancel");},showLoading:function(){var w,h;if(this.$form){w=this.$form.outerWidth();h=this.$form.outerHeight();if(w){this.$loading.width(w);}if(h){this.$loading.height(h);}this.$form.hide();}else{w=this.$loading.parent().width();if(w){this.$loading.width(w);}}this.$loading.show();},showForm:function(activate){this.$loading.hide();this.$form.show();if(activate!==false){this.input.activate();}this.$div.triggerHandler("show");},error:function(msg){var $group=this.$form.find(".control-group"),$block=this.$form.find(".editable-error-block"),lines;if(msg===false){$group.removeClass($.fn.editableform.errorGroupClass);$block.removeClass($.fn.editableform.errorBlockClass).empty().hide();}else{if(msg){lines=msg.split("\n");for(var i=0;i<lines.length;i++){lines[i]=$("<div>").text(lines[i]).html();}msg=lines.join("<br>");}$group.addClass($.fn.editableform.errorGroupClass);$block.addClass($.fn.editableform.errorBlockClass).html(msg).show();}},submit:function(e){e.stopPropagation();e.preventDefault();var error,newValue=this.input.input2value();if(error=this.validate(newValue)){this.error(error);this.showForm();return;}if(!this.options.savenochange&&this.input.value2str(newValue)==this.input.value2str(this.value)){this.$div.triggerHandler("nochange");return;}$.when(this.save(newValue)).done($.proxy(function(response){var res=typeof this.options.success==="function"?this.options.success.call(this.options.scope,response,newValue):null;if(res===false){this.error(false);this.showForm(false);return;}if(typeof res==="string"){this.error(res);this.showForm();return;}if(res&&typeof res==="object"&&res.hasOwnProperty("newValue")){newValue=res.newValue;}this.error(false);this.value=newValue;this.$div.triggerHandler("save",{newValue:newValue,response:response});},this)).fail($.proxy(function(xhr){this.error(typeof xhr==="string"?xhr:xhr.responseText||xhr.statusText||"Unknown error!");this.showForm();},this));},save:function(newValue){var submitValue=this.input.value2submit(newValue);this.options.pk=$.fn.editableutils.tryParseJson(this.options.pk,true);var pk=(typeof this.options.pk==="function")?this.options.pk.call(this.options.scope):this.options.pk,send=!!(typeof this.options.url==="function"||(this.options.url&&((this.options.send==="always")||(this.options.send==="auto"&&pk)))),params;if(send){this.showLoading();params={name:this.options.name||"",value:submitValue,pk:pk};if(typeof this.options.params==="function"){params=this.options.params.call(this.options.scope,params);}else{this.options.params=$.fn.editableutils.tryParseJson(this.options.params,true);$.extend(params,this.options.params);}if(typeof this.options.url==="function"){return this.options.url.call(this.options.scope,params);}else{return $.ajax($.extend({url:this.options.url,data:params,type:"POST"},this.options.ajaxOptions));}}},validate:function(value){if(value===undefined){value=this.value;}if(typeof this.options.validate==="function"){return this.options.validate.call(this.options.scope,value);}},option:function(key,value){if(key in this.options){this.options[key]=value;}if(key==="value"){this.setValue(value);}},setValue:function(value,convertStr){if(convertStr){this.value=this.input.str2value(value);}else{this.value=value;}if(this.$form&&this.$form.is(":visible")){this.input.value2input(this.value);}}};$.fn.editableform=function(option){var args=arguments;return this.each(function(){var $this=$(this),data=$this.data("editableform"),options=typeof option==="object"&&option;if(!data){$this.data("editableform",(data=new EditableForm(this,options)));}if(typeof option==="string"){data[option].apply(data,Array.prototype.slice.call(args,1));}});};$.fn.editableform.Constructor=EditableForm;$.fn.editableform.defaults={type:"text",url:null,params:null,name:null,pk:null,value:null,send:"auto",validate:null,success:null,ajaxOptions:null,showbuttons:true,scope:null,savenochange:false};$.fn.editableform.template='<form class="form-inline editableform"><div class="control-group"><div><div class="editable-input"></div><div class="editable-buttons"></div></div><div class="editable-error-block"></div></div></form>';$.fn.editableform.loading='<div class="editableform-loading"></div>';$.fn.editableform.buttons='<button type="submit" class="editable-submit">ok</button><button type="button" class="editable-cancel">cancel</button>';$.fn.editableform.errorGroupClass=null;$.fn.editableform.errorBlockClass="editable-error";}(window.jQuery));(function($){$.fn.editableutils={inherit:function(Child,Parent){var F=function(){};F.prototype=Parent.prototype;Child.prototype=new F();Child.prototype.constructor=Child;Child.superclass=Parent.prototype;},setCursorPosition:function(elem,pos){if(elem.setSelectionRange){elem.setSelectionRange(pos,pos);}else{if(elem.createTextRange){var range=elem.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select();}}},tryParseJson:function(s,safe){if(typeof s==="string"&&s.length&&s.match(/^[\{\[].*[\}\]]$/)){if(safe){try{s=(new Function("return "+s))();}catch(e){}finally{return s;}}else{s=(new Function("return "+s))();}}return s;},sliceObj:function(obj,keys,caseSensitive){var key,keyLower,newObj={};if(!$.isArray(keys)||!keys.length){return newObj;}for(var i=0;i<keys.length;i++){key=keys[i];if(obj.hasOwnProperty(key)){newObj[key]=obj[key];}if(caseSensitive===true){continue;}keyLower=key.toLowerCase();if(obj.hasOwnProperty(keyLower)){newObj[key]=obj[keyLower];}}return newObj;},getConfigData:function($element){var data={};$.each($element.data(),function(k,v){if(typeof v!=="object"||(v&&typeof v==="object"&&(v.constructor===Object||v.constructor===Array))){data[k]=v;}});return data;},objectKeys:function(o){if(Object.keys){return Object.keys(o);}else{if(o!==Object(o)){throw new TypeError("Object.keys called on a non-object");}var k=[],p;for(p in o){if(Object.prototype.hasOwnProperty.call(o,p)){k.push(p);}}return k;}},escape:function(str){return $("<div>").text(str).html();},itemsByValue:function(value,sourceData,valueProp){if(!sourceData||value===null){return[];}valueProp=valueProp||"value";var isValArray=$.isArray(value),result=[],that=this;$.each(sourceData,function(i,o){if(o.children){result=result.concat(that.itemsByValue(value,o.children,valueProp));}else{if(isValArray){if($.grep(value,function(v){return v==(o&&typeof o==="object"?o[valueProp]:o);}).length){result.push(o);}}else{if(value==(o&&typeof o==="object"?o[valueProp]:o)){result.push(o);}}}});return result;},createInput:function(options){var TypeConstructor,typeOptions,input,type=options.type;if(type==="date"){if(options.mode==="inline"){if($.fn.editabletypes.datefield){type="datefield";}else{if($.fn.editabletypes.dateuifield){type="dateuifield";}}}else{if($.fn.editabletypes.date){type="date";}else{if($.fn.editabletypes.dateui){type="dateui";}}}if(type==="date"&&!$.fn.editabletypes.date){type="combodate";}}if(type==="datetime"&&options.mode==="inline"){type="datetimefield";}if(type==="wysihtml5"&&!$.fn.editabletypes[type]){type="textarea";}if(typeof $.fn.editabletypes[type]==="function"){TypeConstructor=$.fn.editabletypes[type];typeOptions=this.sliceObj(options,this.objectKeys(TypeConstructor.defaults));input=new TypeConstructor(typeOptions);return input;}else{$.error("Unknown type: "+type);return false;}}};}(window.jQuery));(function($){var Popup=function(element,options){this.init(element,options);};var Inline=function(element,options){this.init(element,options);};Popup.prototype={containerName:null,innerCss:null,init:function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.editableContainer.defaults,options);this.splitOptions();this.formOptions.scope=this.$element[0];this.initContainer();this.$element.on("destroyed",$.proxy(function(){this.destroy();},this));if(!$(document).data("editable-handlers-attached")){$(document).on("keyup.editable",function(e){if(e.which===27){$(".editable-open").editableContainer("hide");}});$(document).on("click.editable",function(e){var $target=$(e.target),i,exclude_classes=[".editable-container",".ui-datepicker-header",".modal-backdrop",".bootstrap-wysihtml5-insert-image-modal",".bootstrap-wysihtml5-insert-link-modal"];for(i=0;i<exclude_classes.length;i++){if($target.is(exclude_classes[i])||$target.parents(exclude_classes[i]).length){return;}}if($target.is(document)){return;}Popup.prototype.closeOthers(e.target);});$(document).data("editable-handlers-attached",true);}},splitOptions:function(){this.containerOptions={};this.formOptions={};var cDef=$.fn[this.containerName].defaults;for(var k in this.options){if(k in cDef){this.containerOptions[k]=this.options[k];}else{this.formOptions[k]=this.options[k];}}},tip:function(){return this.container()?this.container().$tip:null;},container:function(){return this.$element.data(this.containerDataName||this.containerName);},call:function(){this.$element[this.containerName].apply(this.$element,arguments);},initContainer:function(){this.call(this.containerOptions);},renderForm:function(){this.$form.editableform(this.formOptions).on({save:$.proxy(this.save,this),nochange:$.proxy(function(){this.hide("nochange");},this),cancel:$.proxy(function(){this.hide("cancel");},this),show:$.proxy(this.setPosition,this),rendering:$.proxy(this.setPosition,this),resize:$.proxy(this.setPosition,this),rendered:$.proxy(function(){this.$element.triggerHandler("shown");},this)}).editableform("render");},show:function(closeAll){this.$element.addClass("editable-open");if(closeAll!==false){this.closeOthers(this.$element[0]);}this.innerShow();this.tip().addClass("editable-container");if(this.$form){}this.$form=$("<div>");if(this.tip().is(this.innerCss)){this.tip().append(this.$form);}else{this.tip().find(this.innerCss).append(this.$form);}this.renderForm();},hide:function(reason){if(!this.tip()||!this.tip().is(":visible")||!this.$element.hasClass("editable-open")){return;}this.$element.removeClass("editable-open");this.innerHide();this.$element.triggerHandler("hidden",reason);},innerShow:function(){},innerHide:function(){},toggle:function(closeAll){if(this.container()&&this.tip()&&this.tip().is(":visible")){this.hide();}else{this.show(closeAll);}},setPosition:function(){},save:function(e,params){this.$element.triggerHandler("save",params);this.hide("save");},option:function(key,value){this.options[key]=value;if(key in this.containerOptions){this.containerOptions[key]=value;this.setContainerOption(key,value);}else{this.formOptions[key]=value;if(this.$form){this.$form.editableform("option",key,value);}}},setContainerOption:function(key,value){this.call("option",key,value);},destroy:function(){this.hide();this.innerDestroy();this.$element.off("destroyed");this.$element.removeData("editableContainer");},innerDestroy:function(){},closeOthers:function(element){$(".editable-open").each(function(i,el){if(el===element||$(el).find(element).length){return;}var $el=$(el),ec=$el.data("editableContainer");if(!ec){return;}if(ec.options.onblur==="cancel"){$el.data("editableContainer").hide("onblur");}else{if(ec.options.onblur==="submit"){$el.data("editableContainer").tip().find("form").submit();}}});},activate:function(){if(this.tip&&this.tip().is(":visible")&&this.$form){this.$form.data("editableform").input.activate();}}};$.fn.editableContainer=function(option){var args=arguments;return this.each(function(){var $this=$(this),dataKey="editableContainer",data=$this.data(dataKey),options=typeof option==="object"&&option,Constructor=(options.mode==="inline")?Inline:Popup;if(!data){$this.data(dataKey,(data=new Constructor(this,options)));}if(typeof option==="string"){data[option].apply(data,Array.prototype.slice.call(args,1));}});};$.fn.editableContainer.Popup=Popup;$.fn.editableContainer.Inline=Inline;$.fn.editableContainer.defaults={value:null,placement:"top",autohide:true,onblur:"cancel",anim:false,mode:"popup"};jQuery.event.special.destroyed={remove:function(o){if(o.handler){o.handler();}}};}(window.jQuery));(function($){$.extend($.fn.editableContainer.Inline.prototype,$.fn.editableContainer.Popup.prototype,{containerName:"editableform",innerCss:".editable-inline",initContainer:function(){this.$tip=$("<span></span>").addClass("editable-inline");if(!this.options.anim){this.options.anim=0;}},splitOptions:function(){this.containerOptions={};this.formOptions=this.options;},tip:function(){return this.$tip;},innerShow:function(){this.$element.hide();this.tip().insertAfter(this.$element).show();},innerHide:function(){this.$tip.hide(this.options.anim,$.proxy(function(){this.$element.show();this.innerDestroy();},this));},innerDestroy:function(){if(this.tip()){this.tip().empty().remove();}}});}(window.jQuery));(function($){var Editable=function(element,options){this.$element=$(element);this.options=$.extend({},$.fn.editable.defaults,options,$.fn.editableutils.getConfigData(this.$element));if(this.options.selector){this.initLive();}else{this.init();}};Editable.prototype={constructor:Editable,init:function(){var isValueByText=false,doAutotext,finalize;this.options.name=this.options.name||this.$element.attr("id");this.options.scope=this.$element[0];this.input=$.fn.editableutils.createInput(this.options);if(!this.input){return;}if(this.options.value===undefined||this.options.value===null){this.value=this.input.html2value($.trim(this.$element.html()));isValueByText=true;}else{this.options.value=$.fn.editableutils.tryParseJson(this.options.value,true);if(typeof this.options.value==="string"){this.value=this.input.str2value(this.options.value);}else{this.value=this.options.value;}}this.$element.addClass("editable");if(this.options.toggle!=="manual"){this.$element.addClass("editable-click");this.$element.on(this.options.toggle+".editable",$.proxy(function(e){e.preventDefault();if(this.options.toggle==="mouseenter"){this.show();}else{var closeAll=(this.options.toggle!=="click");this.toggle(closeAll);}},this));}else{this.$element.attr("tabindex",-1);}switch(this.options.autotext){case"always":doAutotext=true;break;case"auto":doAutotext=!$.trim(this.$element.text()).length&&this.value!==null&&this.value!==undefined&&!isValueByText;break;default:doAutotext=false;}$.when(doAutotext?this.render():true).then($.proxy(function(){if(this.options.disabled){this.disable();}else{this.enable();}this.$element.triggerHandler("init",this);},this));},initLive:function(){var selector=this.options.selector;this.options.selector=false;this.options.autotext="never";this.$element.on(this.options.toggle+".editable",selector,$.proxy(function(e){var $target=$(e.target);if(!$target.data("editable")){if($target.hasClass(this.options.emptyclass)){$target.empty();}$target.editable(this.options).trigger(e);}},this));},render:function(response){if(this.options.display===false){return;}if(this.input.value2htmlFinal){return this.input.value2html(this.value,this.$element[0],this.options.display,response);}else{if(typeof this.options.display==="function"){return this.options.display.call(this.$element[0],this.value,response);}else{return this.input.value2html(this.value,this.$element[0]);}}},enable:function(){this.options.disabled=false;this.$element.removeClass("editable-disabled");this.handleEmpty(this.isEmpty);if(this.options.toggle!=="manual"){if(this.$element.attr("tabindex")==="-1"){this.$element.removeAttr("tabindex");}}},disable:function(){this.options.disabled=true;this.hide();this.$element.addClass("editable-disabled");this.handleEmpty(this.isEmpty);this.$element.attr("tabindex",-1);},toggleDisabled:function(){if(this.options.disabled){this.enable();}else{this.disable();}},option:function(key,value){if(key&&typeof key==="object"){$.each(key,$.proxy(function(k,v){this.option($.trim(k),v);},this));return;}this.options[key]=value;if(key==="disabled"){return value?this.disable():this.enable();}if(key==="value"){this.setValue(value);}if(this.container){this.container.option(key,value);}if(this.input.option){this.input.option(key,value);}},handleEmpty:function(isEmpty){if(this.options.display===false){return;}this.isEmpty=isEmpty!==undefined?isEmpty:$.trim(this.$element.text())==="";if(!this.options.disabled){if(this.isEmpty){this.$element.text(this.options.emptytext);if(this.options.emptyclass){this.$element.addClass(this.options.emptyclass);}}else{if(this.options.emptyclass){this.$element.removeClass(this.options.emptyclass);}}}else{if(this.isEmpty){this.$element.empty();if(this.options.emptyclass){this.$element.removeClass(this.options.emptyclass);}}}},show:function(closeAll){if(this.options.disabled){return;}if(!this.container){var containerOptions=$.extend({},this.options,{value:this.value,input:this.input});this.$element.editableContainer(containerOptions);this.$element.on("save.internal",$.proxy(this.save,this));this.container=this.$element.data("editableContainer");}else{if(this.container.tip().is(":visible")){return;}}this.container.show(closeAll);},hide:function(){if(this.container){this.container.hide();}},toggle:function(closeAll){if(this.container&&this.container.tip().is(":visible")){this.hide();}else{this.show(closeAll);}},save:function(e,params){if(this.options.unsavedclass){var sent=false;sent=sent||typeof this.options.url==="function";sent=sent||this.options.display===false;sent=sent||params.response!==undefined;sent=sent||(this.options.savenochange&&this.input.value2str(this.value)!==this.input.value2str(params.newValue));if(sent){this.$element.removeClass(this.options.unsavedclass);}else{this.$element.addClass(this.options.unsavedclass);}}this.setValue(params.newValue,false,params.response);},validate:function(){if(typeof this.options.validate==="function"){return this.options.validate.call(this,this.value);}},setValue:function(value,convertStr,response){if(convertStr){this.value=this.input.str2value(value);}else{this.value=value;}if(this.container){this.container.option("value",this.value);}$.when(this.render(response)).then($.proxy(function(){this.handleEmpty();},this));},activate:function(){if(this.container){this.container.activate();}},destroy:function(){if(this.container){this.container.destroy();}if(this.options.toggle!=="manual"){this.$element.removeClass("editable-click");this.$element.off(this.options.toggle+".editable");}this.$element.off("save.internal");this.$element.removeClass("editable");this.$element.removeClass("editable-open");this.$element.removeData("editable");}};$.fn.editable=function(option){var result={},args=arguments,datakey="editable";switch(option){case"validate":this.each(function(){var $this=$(this),data=$this.data(datakey),error;if(data&&(error=data.validate())){result[data.options.name]=error;}});return result;case"getValue":this.each(function(){var $this=$(this),data=$this.data(datakey);if(data&&data.value!==undefined&&data.value!==null){result[data.options.name]=data.input.value2submit(data.value);}});return result;case"submit":var config=arguments[1]||{},$elems=this,errors=this.editable("validate"),values;if($.isEmptyObject(errors)){values=this.editable("getValue");if(config.data){$.extend(values,config.data);}$.ajax($.extend({url:config.url,data:values,type:"POST"},config.ajaxOptions)).success(function(response){if(typeof config.success==="function"){config.success.call($elems,response,config);}}).error(function(){if(typeof config.error==="function"){config.error.apply($elems,arguments);}});}else{if(typeof config.error==="function"){config.error.call($elems,errors);}}return this;}return this.each(function(){var $this=$(this),data=$this.data(datakey),options=typeof option==="object"&&option;if(!data){$this.data(datakey,(data=new Editable(this,options)));}if(typeof option==="string"){data[option].apply(data,Array.prototype.slice.call(args,1));}});};$.fn.editable.defaults={type:"text",disabled:false,toggle:"click",emptytext:"Empty",autotext:"auto",value:null,display:null,emptyclass:"editable-empty",unsavedclass:"editable-unsaved",selector:null};}(window.jQuery));(function($){$.fn.editabletypes={};var AbstractInput=function(){};AbstractInput.prototype={init:function(type,options,defaults){this.type=type;this.options=$.extend({},defaults,options);},prerender:function(){this.$tpl=$(this.options.tpl);this.$input=this.$tpl;this.$clear=null;this.error=null;},render:function(){},value2html:function(value,element){$(element).text(value);},html2value:function(html){return $("<div>").html(html).text();},value2str:function(value){return value;},str2value:function(str){return str;},value2submit:function(value){return value;},value2input:function(value){this.$input.val(value);},input2value:function(){return this.$input.val();},activate:function(){if(this.$input.is(":visible")){this.$input.focus();}},clear:function(){this.$input.val(null);},escape:function(str){return $("<div>").text(str).html();},autosubmit:function(){},setClass:function(){if(this.options.inputclass){this.$input.addClass(this.options.inputclass);}},setAttr:function(attr){if(this.options[attr]!==undefined&&this.options[attr]!==null){this.$input.attr(attr,this.options[attr]);}},option:function(key,value){this.options[key]=value;}};AbstractInput.defaults={tpl:"",inputclass:"input-medium",scope:null,showbuttons:true};$.extend($.fn.editabletypes,{abstractinput:AbstractInput});}(window.jQuery));(function($){var List=function(options){};$.fn.editableutils.inherit(List,$.fn.editabletypes.abstractinput);$.extend(List.prototype,{render:function(){var deferred=$.Deferred();this.error=null;this.onSourceReady(function(){this.renderList();deferred.resolve();},function(){this.error=this.options.sourceError;deferred.resolve();});return deferred.promise();},html2value:function(html){return null;},value2html:function(value,element,display,response){var deferred=$.Deferred(),success=function(){if(typeof display==="function"){display.call(element,value,this.sourceData,response);}else{this.value2htmlFinal(value,element);}deferred.resolve();};if(value===null){success.call(this);}else{this.onSourceReady(success,function(){deferred.resolve();});}return deferred.promise();},onSourceReady:function(success,error){if($.isArray(this.sourceData)){success.call(this);return;}try{this.options.source=$.fn.editableutils.tryParseJson(this.options.source,false);}catch(e){error.call(this);return;}var source=this.options.source;if($.isFunction(source)){source=source.call(this.options.scope);}if(typeof source==="string"){if(this.options.sourceCache){var cacheID=source,cache;if(!$(document).data(cacheID)){$(document).data(cacheID,{});}cache=$(document).data(cacheID);if(cache.loading===false&&cache.sourceData){this.sourceData=cache.sourceData;this.doPrepend();success.call(this);return;}else{if(cache.loading===true){cache.callbacks.push($.proxy(function(){this.sourceData=cache.sourceData;this.doPrepend();success.call(this);},this));cache.err_callbacks.push($.proxy(error,this));return;}else{cache.loading=true;cache.callbacks=[];cache.err_callbacks=[];}}}$.ajax({url:source,type:"get",cache:false,dataType:"json",success:$.proxy(function(data){if(cache){cache.loading=false;}this.sourceData=this.makeArray(data);if($.isArray(this.sourceData)){if(cache){cache.sourceData=this.sourceData;$.each(cache.callbacks,function(){this.call();});}this.doPrepend();success.call(this);}else{error.call(this);if(cache){$.each(cache.err_callbacks,function(){this.call();});}}},this),error:$.proxy(function(){error.call(this);if(cache){cache.loading=false;$.each(cache.err_callbacks,function(){this.call();});}},this)});}else{this.sourceData=this.makeArray(source);if($.isArray(this.sourceData)){this.doPrepend();success.call(this);}else{error.call(this);}}},doPrepend:function(){if(this.options.prepend===null||this.options.prepend===undefined){return;}if(!$.isArray(this.prependData)){if($.isFunction(this.options.prepend)){this.options.prepend=this.options.prepend.call(this.options.scope);}this.options.prepend=$.fn.editableutils.tryParseJson(this.options.prepend,true);if(typeof this.options.prepend==="string"){this.options.prepend={"":this.options.prepend};}this.prependData=this.makeArray(this.options.prepend);}if($.isArray(this.prependData)&&$.isArray(this.sourceData)){this.sourceData=this.prependData.concat(this.sourceData);}},renderList:function(){},value2htmlFinal:function(value,element){},makeArray:function(data){var count,obj,result=[],item,iterateItem;if(!data||typeof data==="string"){return null;}if($.isArray(data)){iterateItem=function(k,v){obj={value:k,text:v};if(count++>=2){return false;}};for(var i=0;i<data.length;i++){item=data[i];if(typeof item==="object"){count=0;$.each(item,iterateItem);if(count===1){result.push(obj);}else{if(count>1){if(item.children){item.children=this.makeArray(item.children);}result.push(item);}}}else{result.push({value:item,text:item});}}}else{$.each(data,function(k,v){result.push({value:k,text:v});});}return result;},option:function(key,value){this.options[key]=value;if(key==="source"){this.sourceData=null;}if(key==="prepend"){this.prependData=null;}}});List.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{source:null,prepend:false,sourceError:"Error when loading list",sourceCache:true});$.fn.editabletypes.list=List;}(window.jQuery));(function($){var Text=function(options){this.init("text",options,Text.defaults);};$.fn.editableutils.inherit(Text,$.fn.editabletypes.abstractinput);$.extend(Text.prototype,{render:function(){this.renderClear();this.setClass();this.setAttr("placeholder");},activate:function(){if(this.$input.is(":visible")){this.$input.focus();$.fn.editableutils.setCursorPosition(this.$input.get(0),this.$input.val().length);if(this.toggleClear){this.toggleClear();}}},renderClear:function(){if(this.options.clear){this.$clear=$('<span class="editable-clear-x"></span>');this.$input.after(this.$clear).css("padding-right",24).keyup($.proxy(function(e){if(~$.inArray(e.keyCode,[40,38,9,13,27])){return;}clearTimeout(this.t);var that=this;this.t=setTimeout(function(){that.toggleClear(e);},100);},this)).parent().css("position","relative");this.$clear.click($.proxy(this.clear,this));}},postrender:function(){if(this.$clear){var h=this.$input.outerHeight()||20,delta=(h-this.$clear.height())/2;if(delta<3){delta=3;}this.$clear.css({bottom:delta,right:delta});}},toggleClear:function(e){if(!this.$clear){return;}var len=this.$input.val().length,visible=this.$clear.is(":visible");if(len&&!visible){this.$clear.show();}if(!len&&visible){this.$clear.hide();}},clear:function(){this.$clear.hide();this.$input.val("").focus();}});Text.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',placeholder:null,clear:true});$.fn.editabletypes.text=Text;}(window.jQuery));(function($){var Textarea=function(options){this.init("textarea",options,Textarea.defaults);};$.fn.editableutils.inherit(Textarea,$.fn.editabletypes.abstractinput);$.extend(Textarea.prototype,{render:function(){this.setClass();this.setAttr("placeholder");this.setAttr("rows");this.$input.keydown(function(e){if(e.ctrlKey&&e.which===13){$(this).closest("form").submit();}});},value2html:function(value,element){var html="",lines;if(value){lines=value.split("\n");for(var i=0;i<lines.length;i++){lines[i]=$("<div>").text(lines[i]).html();}html=lines.join("<br>");}$(element).html(html);},html2value:function(html){if(!html){return"";}var regex=new RegExp(String.fromCharCode(10),"g");var lines=html.split(/<br\s*\/?>/i);for(var i=0;i<lines.length;i++){var text=$("<div>").html(lines[i]).text();text=text.replace(regex,"");lines[i]=text;}return lines.join("\n");},activate:function(){$.fn.editabletypes.text.prototype.activate.call(this);}});Textarea.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:"<textarea></textarea>",inputclass:"input-large",placeholder:null,rows:7});$.fn.editabletypes.textarea=Textarea;}(window.jQuery));(function($){var Select=function(options){this.init("select",options,Select.defaults);};$.fn.editableutils.inherit(Select,$.fn.editabletypes.list);$.extend(Select.prototype,{renderList:function(){this.$input.empty();var fillItems=function($el,data){if($.isArray(data)){for(var i=0;i<data.length;i++){if(data[i].children){$el.append(fillItems($("<optgroup>",{label:data[i].text}),data[i].children));}else{$el.append($("<option>",{value:data[i].value}).text(data[i].text));}}}return $el;};fillItems(this.$input,this.sourceData);this.setClass();this.$input.on("keydown.editable",function(e){if(e.which===13){$(this).closest("form").submit();}});},value2htmlFinal:function(value,element){var text="",items=$.fn.editableutils.itemsByValue(value,this.sourceData);if(items.length){text=items[0].text;}$(element).text(text);},autosubmit:function(){this.$input.off("keydown.editable").on("change.editable",function(){$(this).closest("form").submit();});}});Select.defaults=$.extend({},$.fn.editabletypes.list.defaults,{tpl:"<select></select>"});$.fn.editabletypes.select=Select;}(window.jQuery));(function($){var Checklist=function(options){this.init("checklist",options,Checklist.defaults);};$.fn.editableutils.inherit(Checklist,$.fn.editabletypes.list);$.extend(Checklist.prototype,{renderList:function(){var $label,$div;this.$tpl.empty();if(!$.isArray(this.sourceData)){return;}for(var i=0;i<this.sourceData.length;i++){$label=$("<label>").append($("<input>",{type:"checkbox",value:this.sourceData[i].value})).append($("<span>").text(" "+this.sourceData[i].text));$("<div>").append($label).appendTo(this.$tpl);}this.$input=this.$tpl.find('input[type="checkbox"]');this.setClass();},value2str:function(value){return $.isArray(value)?value.sort().join($.trim(this.options.separator)):"";},str2value:function(str){var reg,value=null;if(typeof str==="string"&&str.length){reg=new RegExp("\\s*"+$.trim(this.options.separator)+"\\s*");value=str.split(reg);}else{if($.isArray(str)){value=str;}else{value=[str];}}return value;},value2input:function(value){this.$input.prop("checked",false);if($.isArray(value)&&value.length){this.$input.each(function(i,el){var $el=$(el);$.each(value,function(j,val){if($el.val()==val){$el.prop("checked",true);}});});}},input2value:function(){var checked=[];this.$input.filter(":checked").each(function(i,el){checked.push($(el).val());});return checked;},value2htmlFinal:function(value,element){var html=[],checked=$.fn.editableutils.itemsByValue(value,this.sourceData);if(checked.length){$.each(checked,function(i,v){html.push($.fn.editableutils.escape(v.text));});$(element).html(html.join("<br>"));}else{$(element).empty();}},activate:function(){this.$input.first().focus();},autosubmit:function(){this.$input.on("keydown",function(e){if(e.which===13){$(this).closest("form").submit();}});}});Checklist.defaults=$.extend({},$.fn.editabletypes.list.defaults,{tpl:'<div class="editable-checklist"></div>',inputclass:null,separator:","});$.fn.editabletypes.checklist=Checklist;}(window.jQuery));(function($){var Password=function(options){this.init("password",options,Password.defaults);};$.fn.editableutils.inherit(Password,$.fn.editabletypes.text);$.extend(Password.prototype,{value2html:function(value,element){if(value){$(element).text("[hidden]");}else{$(element).empty();}},html2value:function(html){return null;}});Password.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="password">'});$.fn.editabletypes.password=Password;}(window.jQuery));(function($){var Email=function(options){this.init("email",options,Email.defaults);};$.fn.editableutils.inherit(Email,$.fn.editabletypes.text);Email.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="email">'});$.fn.editabletypes.email=Email;}(window.jQuery));(function($){var Url=function(options){this.init("url",options,Url.defaults);};$.fn.editableutils.inherit(Url,$.fn.editabletypes.text);Url.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="url">'});$.fn.editabletypes.url=Url;}(window.jQuery));(function($){var Tel=function(options){this.init("tel",options,Tel.defaults);};$.fn.editableutils.inherit(Tel,$.fn.editabletypes.text);Tel.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="tel">'});$.fn.editabletypes.tel=Tel;}(window.jQuery));(function($){var NumberInput=function(options){this.init("number",options,NumberInput.defaults);};$.fn.editableutils.inherit(NumberInput,$.fn.editabletypes.text);$.extend(NumberInput.prototype,{render:function(){NumberInput.superclass.render.call(this);this.setAttr("min");this.setAttr("max");this.setAttr("step");},postrender:function(){if(this.$clear){var h=this.$input.outerHeight()||20,delta=(h-this.$clear.height())/2;if(delta<3){delta=3;}this.$clear.css({bottom:delta,right:delta+12});}}});NumberInput.defaults=$.extend({},$.fn.editabletypes.text.defaults,{tpl:'<input type="number">',inputclass:"input-mini",min:null,max:null,step:null});$.fn.editabletypes.number=NumberInput;}(window.jQuery));(function($){var Range=function(options){this.init("range",options,Range.defaults);};$.fn.editableutils.inherit(Range,$.fn.editabletypes.number);$.extend(Range.prototype,{render:function(){this.$input=this.$tpl.filter("input");this.setClass();this.setAttr("min");this.setAttr("max");this.setAttr("step");this.$input.on("input",function(){$(this).siblings("output").text($(this).val());});},activate:function(){this.$input.focus();}});Range.defaults=$.extend({},$.fn.editabletypes.number.defaults,{tpl:'<input type="range"><output style="width: 30px; display: inline-block"></output>',inputclass:"input-medium"});$.fn.editabletypes.range=Range;}(window.jQuery));(function($){var Constructor=function(options){this.init("select2",options,Constructor.defaults);options.select2=options.select2||{};var that=this,mixin={placeholder:options.placeholder};this.isMultiple=options.select2.tags||options.select2.multiple;if(!options.select2.tags){if(options.source){mixin.data=options.source;}mixin.initSelection=function(element,callback){var val=that.str2value(element.val()),data=$.fn.editableutils.itemsByValue(val,mixin.data,"id");if($.isArray(data)&&data.length&&!that.isMultiple){data=data[0];}callback(data);};}this.options.select2=$.extend({},Constructor.defaults.select2,mixin,options.select2);};$.fn.editableutils.inherit(Constructor,$.fn.editabletypes.abstractinput);$.extend(Constructor.prototype,{render:function(){this.setClass();this.$input.select2(this.options.select2);if("ajax" in this.options.select2){}if(this.isMultiple){this.$input.on("change",function(){$(this).closest("form").parent().triggerHandler("resize");});}},value2html:function(value,element){var text="",data;if(this.$input){data=this.$input.select2("data");}else{if(this.options.select2.tags){data=value;}else{if(this.options.select2.data){data=$.fn.editableutils.itemsByValue(value,this.options.select2.data,"id");}else{}}}if($.isArray(data)){text=[];$.each(data,function(k,v){text.push(v&&typeof v==="object"?v.text:v);});}else{if(data){text=data.text;}}text=$.isArray(text)?text.join(this.options.viewseparator):text;$(element).text(text);},html2value:function(html){return this.options.select2.tags?this.str2value(html,this.options.viewseparator):null;},value2input:function(value){this.$input.val(value).trigger("change",true);},input2value:function(){return this.$input.select2("val");},str2value:function(str,separator){if(typeof str!=="string"||!this.isMultiple){return str;}separator=separator||this.options.select2.separator||$.fn.select2.defaults.separator;var val,i,l;if(str===null||str.length<1){return null;}val=str.split(separator);for(i=0,l=val.length;i<l;i=i+1){val[i]=$.trim(val[i]);}return val;},autosubmit:function(){this.$input.on("change",function(e,isInitial){if(!isInitial){$(this).closest("form").submit();}});}});Constructor.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="hidden">',select2:null,placeholder:null,source:null,viewseparator:", "});$.fn.editabletypes.select2=Constructor;}(window.jQuery));(function($){var Combodate=function(element,options){this.$element=$(element);if(!this.$element.is("input")){$.error("Combodate should be applied to INPUT element");return;}this.options=$.extend({},$.fn.combodate.defaults,options,this.$element.data());this.init();};Combodate.prototype={constructor:Combodate,init:function(){this.map={day:["D","date"],month:["M","month"],year:["Y","year"],hour:["[Hh]","hours"],minute:["m","minutes"],second:["s","seconds"],ampm:["[Aa]",""]};this.$widget=$('<span class="combodate"></span>').html(this.getTemplate());this.initCombos();this.$widget.on("change","select",$.proxy(function(){this.$element.val(this.getValue());},this));this.$widget.find("select").css("width","auto");this.$element.hide().after(this.$widget);this.setValue(this.$element.val()||this.options.value);},getTemplate:function(){var tpl=this.options.template;$.each(this.map,function(k,v){v=v[0];var r=new RegExp(v+"+"),token=v.length>1?v.substring(1,2):v;tpl=tpl.replace(r,"{"+token+"}");});tpl=tpl.replace(/ /g,"&nbsp;");$.each(this.map,function(k,v){v=v[0];var token=v.length>1?v.substring(1,2):v;tpl=tpl.replace("{"+token+"}",'<select class="'+k+'"></select>');});return tpl;},initCombos:function(){var that=this;$.each(this.map,function(k,v){var $c=that.$widget.find("."+k),f,items;if($c.length){that["$"+k]=$c;f="fill"+k.charAt(0).toUpperCase()+k.slice(1);items=that[f]();that["$"+k].html(that.renderItems(items));}});},initItems:function(key){var values=[],relTime;if(this.options.firstItem==="name"){relTime=moment.relativeTime||moment.langData()._relativeTime;var header=typeof relTime[key]==="function"?relTime[key](1,true,key,false):relTime[key];header=header.split(" ").reverse()[0];values.push(["",header]);}else{if(this.options.firstItem==="empty"){values.push(["",""]);}}return values;},renderItems:function(items){var str=[];for(var i=0;i<items.length;i++){str.push('<option value="'+items[i][0]+'">'+items[i][1]+"</option>");}return str.join("\n");},fillDay:function(){var items=this.initItems("d"),name,i,twoDigit=this.options.template.indexOf("DD")!==-1;for(i=1;i<=31;i++){name=twoDigit?this.leadZero(i):i;items.push([i,name]);}return items;},fillMonth:function(){var items=this.initItems("M"),name,i,longNames=this.options.template.indexOf("MMMM")!==-1,shortNames=this.options.template.indexOf("MMM")!==-1,twoDigit=this.options.template.indexOf("MM")!==-1;for(i=0;i<=11;i++){if(longNames){name=moment().month(i).format("MMMM");}else{if(shortNames){name=moment().month(i).format("MMM");}else{if(twoDigit){name=this.leadZero(i+1);}else{name=i+1;}}}items.push([i,name]);}return items;},fillYear:function(){var items=this.initItems("y"),name,i,longNames=this.options.template.indexOf("YYYY")!==-1;for(i=this.options.maxYear;i>=this.options.minYear;i--){name=longNames?i:(i+"").substring(2);items.push([i,name]);}return items;},fillHour:function(){var items=this.initItems("h"),name,i,h12=this.options.template.indexOf("h")!==-1,h24=this.options.template.indexOf("H")!==-1,twoDigit=this.options.template.toLowerCase().indexOf("hh")!==-1,max=h12?12:23;for(i=0;i<=max;i++){name=twoDigit?this.leadZero(i):i;items.push([i,name]);}return items;},fillMinute:function(){var items=this.initItems("m"),name,i,twoDigit=this.options.template.indexOf("mm")!==-1;for(i=0;i<=59;i+=this.options.minuteStep){name=twoDigit?this.leadZero(i):i;items.push([i,name]);}return items;},fillSecond:function(){var items=this.initItems("s"),name,i,twoDigit=this.options.template.indexOf("ss")!==-1;for(i=0;i<=59;i+=this.options.secondStep){name=twoDigit?this.leadZero(i):i;items.push([i,name]);}return items;},fillAmpm:function(){var ampmL=this.options.template.indexOf("a")!==-1,ampmU=this.options.template.indexOf("A")!==-1,items=[["am",ampmL?"am":"AM"],["pm",ampmL?"pm":"PM"]];return items;},getValue:function(format){var dt,values={},that=this,notSelected=false;$.each(this.map,function(k,v){if(k==="ampm"){return;}var def=k==="day"?1:0;values[k]=that["$"+k]?parseInt(that["$"+k].val(),10):def;if(isNaN(values[k])){notSelected=true;return false;}});if(notSelected){return"";}if(this.$ampm){values.hour=this.$ampm.val()==="am"?values.hour:values.hour+12;if(values.hour===24){values.hour=0;}}dt=moment([values.year,values.month,values.day,values.hour,values.minute,values.second]);this.highlight(dt);format=format===undefined?this.options.format:format;if(format===null){return dt.isValid()?dt:null;}else{return dt.isValid()?dt.format(format):"";}},setValue:function(value){if(!value){return;}var dt=typeof value==="string"?moment(value,this.options.format):moment(value),that=this,values={};if(dt.isValid()){$.each(this.map,function(k,v){if(k==="ampm"){return;}values[k]=dt[v[1]]();});if(this.$ampm){if(values.hour>12){values.hour-=12;values.ampm="pm";}else{values.ampm="am";}}$.each(values,function(k,v){if(that["$"+k]){that["$"+k].val(v);}});this.$element.val(dt.format(this.options.format));}},highlight:function(dt){if(!dt.isValid()){if(this.options.errorClass){this.$widget.addClass(this.options.errorClass);}else{if(!this.borderColor){this.borderColor=this.$widget.find("select").css("border-color");}this.$widget.find("select").css("border-color","red");}}else{if(this.options.errorClass){this.$widget.removeClass(this.options.errorClass);}else{this.$widget.find("select").css("border-color",this.borderColor);}}},leadZero:function(v){return v<=9?"0"+v:v;},destroy:function(){this.$widget.remove();this.$element.removeData("combodate").show();}};$.fn.combodate=function(option){var d,args=Array.apply(null,arguments);args.shift();if(option==="getValue"&&this.length&&(d=this.eq(0).data("combodate"))){return d.getValue.apply(d,args);}return this.each(function(){var $this=$(this),data=$this.data("combodate"),options=typeof option=="object"&&option;if(!data){$this.data("combodate",(data=new Combodate(this,options)));}if(typeof option=="string"&&typeof data[option]=="function"){data[option].apply(data,args);}});};$.fn.combodate.defaults={format:"DD-MM-YYYY HH:mm",template:"D / MMM / YYYY   H : mm",value:null,minYear:1970,maxYear:2015,minuteStep:5,secondStep:1,firstItem:"empty",errorClass:null};}(window.jQuery));(function($){var Constructor=function(options){this.init("combodate",options,Constructor.defaults);if(!this.options.viewformat){this.options.viewformat=this.options.format;}options.combodate=$.fn.editableutils.tryParseJson(options.combodate,true);this.options.combodate=$.extend({},Constructor.defaults.combodate,options.combodate,{format:this.options.format,template:this.options.template});};$.fn.editableutils.inherit(Constructor,$.fn.editabletypes.abstractinput);$.extend(Constructor.prototype,{render:function(){this.$input.combodate(this.options.combodate);},value2html:function(value,element){var text=value?value.format(this.options.viewformat):"";$(element).text(text);},html2value:function(html){return html?moment(html,this.options.viewformat):null;},value2str:function(value){return value?value.format(this.options.format):"";},str2value:function(str){return str?moment(str,this.options.format):null;},value2submit:function(value){return this.value2str(value);},value2input:function(value){this.$input.combodate("setValue",value);},input2value:function(){return this.$input.combodate("getValue",null);},activate:function(){this.$input.siblings(".combodate").find("select").eq(0).focus();},autosubmit:function(){}});Constructor.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<input type="text">',inputclass:null,format:"YYYY-MM-DD",viewformat:null,template:"D / MMM / YYYY",combodate:null});$.fn.editabletypes.combodate=Constructor;}(window.jQuery));(function($){$.extend($.fn.editableform.Constructor.prototype,{initTemplate:function(){this.$form=$($.fn.editableform.template);this.$form.find(".editable-error-block").addClass("help-block");}});$.fn.editableform.buttons='<button type="submit" class="btn btn-primary editable-submit"><i class="icon-ok icon-white"></i></button><button type="button" class="btn editable-cancel"><i class="icon-remove"></i></button>';$.fn.editableform.errorGroupClass="error";$.fn.editableform.errorBlockClass=null;}(window.jQuery));(function($){$.extend($.fn.editableContainer.Popup.prototype,{containerName:"popover",innerCss:$($.fn.popover.defaults.template).find("p").length?".popover-content p":".popover-content",initContainer:function(){$.extend(this.containerOptions,{trigger:"manual",selector:false,content:" ",template:$.fn.popover.defaults.template});var t;if(this.$element.data("template")){t=this.$element.data("template");this.$element.removeData("template");}this.call(this.containerOptions);if(t){this.$element.data("template",t);}},innerShow:function(){this.call("show");},innerHide:function(){this.call("hide");},innerDestroy:function(){this.call("destroy");},setContainerOption:function(key,value){this.container().options[key]=value;},setPosition:function(){(function(){var $tip=this.tip(),inside,pos,actualWidth,actualHeight,placement,tp;placement=typeof this.options.placement==="function"?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement;inside=/in/.test(placement);$tip.removeClass("top right bottom left").css({top:0,left:0,display:"block"});pos=this.getPosition(inside);actualWidth=$tip[0].offsetWidth;actualHeight=$tip[0].offsetHeight;switch(inside?placement.split(" ")[1]:placement){case"bottom":tp={top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2};break;case"top":tp={top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2};break;case"left":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth};break;case"right":tp={top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width};break;}$tip.offset(tp).addClass(placement).addClass("in");}).call(this.container());}});}(window.jQuery));(function($){var Date=function(options){this.init("date",options,Date.defaults);this.initPicker(options,Date.defaults);};$.fn.editableutils.inherit(Date,$.fn.editabletypes.abstractinput);$.extend(Date.prototype,{initPicker:function(options,defaults){if(!this.options.viewformat){this.options.viewformat=this.options.format;}this.options.datepicker=$.extend({},defaults.datepicker,options.datepicker,{format:this.options.viewformat});this.options.datepicker.language=this.options.datepicker.language||"en";this.dpg=$.fn.datepicker.DPGlobal;this.parsedFormat=this.dpg.parseFormat(this.options.format);this.parsedViewFormat=this.dpg.parseFormat(this.options.viewformat);},render:function(){this.$input.datepicker(this.options.datepicker);if(this.options.clear){this.$clear=$('<a href="#"></a>').html(this.options.clear).click($.proxy(function(e){e.preventDefault();e.stopPropagation();this.clear();},this));this.$tpl.parent().append($('<div class="editable-clear">').append(this.$clear));}},value2html:function(value,element){var text=value?this.dpg.formatDate(value,this.parsedViewFormat,this.options.datepicker.language):"";Date.superclass.value2html(text,element);},html2value:function(html){return html?this.dpg.parseDate(html,this.parsedViewFormat,this.options.datepicker.language):null;},value2str:function(value){return value?this.dpg.formatDate(value,this.parsedFormat,this.options.datepicker.language):"";},str2value:function(str){return str?this.dpg.parseDate(str,this.parsedFormat,this.options.datepicker.language):null;},value2submit:function(value){return this.value2str(value);},value2input:function(value){this.$input.datepicker("update",value);},input2value:function(){return this.$input.data("datepicker").date;},activate:function(){},clear:function(){this.$input.data("datepicker").date=null;this.$input.find(".active").removeClass("active");if(!this.options.showbuttons){this.$input.closest("form").submit();}},autosubmit:function(){this.$input.on("mouseup",".day",function(e){if($(e.currentTarget).is(".old")||$(e.currentTarget).is(".new")){return;}var $form=$(this).closest("form");setTimeout(function(){$form.submit();},200);});}});Date.defaults=$.extend({},$.fn.editabletypes.abstractinput.defaults,{tpl:'<div class="editable-date well"></div>',inputclass:null,format:"yyyy-mm-dd",viewformat:null,datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:false},clear:"&times; clear"});$.fn.editabletypes.date=Date;}(window.jQuery));(function($){var DateField=function(options){this.init("datefield",options,DateField.defaults);this.initPicker(options,DateField.defaults);};$.fn.editableutils.inherit(DateField,$.fn.editabletypes.date);$.extend(DateField.prototype,{render:function(){this.$input=this.$tpl.find("input");this.setClass();this.setAttr("placeholder");this.$tpl.datepicker(this.options.datepicker);this.$input.off("focus keydown");this.$input.keyup($.proxy(function(){this.$tpl.removeData("date");this.$tpl.datepicker("update");},this));},value2input:function(value){this.$input.val(value?this.dpg.formatDate(value,this.parsedViewFormat,this.options.datepicker.language):"");this.$tpl.datepicker("update");},input2value:function(){return this.html2value(this.$input.val());},activate:function(){$.fn.editabletypes.text.prototype.activate.call(this);},autosubmit:function(){}});DateField.defaults=$.extend({},$.fn.editabletypes.date.defaults,{tpl:'<div class="input-append date"><input type="text"/><span class="add-on"><i class="icon-th"></i></span></div>',inputclass:"input-small",datepicker:{weekStart:0,startView:0,minViewMode:0,autoclose:true}});$.fn.editabletypes.datefield=DateField;}(window.jQuery));!function($){function UTCDate(){return new Date(Date.UTC.apply(Date,arguments));}function UTCToday(){var today=new Date();return UTCDate(today.getUTCFullYear(),today.getUTCMonth(),today.getUTCDate());}var Datepicker=function(element,options){var that=this;this.element=$(element);this.language=options.language||this.element.data("date-language")||"en";this.language=this.language in dates?this.language:this.language.split("-")[0];this.language=this.language in dates?this.language:"en";this.isRTL=dates[this.language].rtl||false;this.format=DPGlobal.parseFormat(options.format||this.element.data("date-format")||dates[this.language].format||"mm/dd/yyyy");this.isInline=false;this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;this.hasInput=this.component&&this.element.find("input").length;if(this.component&&this.component.length===0){this.component=false;}this._attachEvents();this.forceParse=true;if("forceParse" in options){this.forceParse=options.forceParse;}else{if("dateForceParse" in this.element.data()){this.forceParse=this.element.data("date-force-parse");}}this.picker=$(DPGlobal.template).appendTo(this.isInline?this.element:"body").on({click:$.proxy(this.click,this),mousedown:$.proxy(this.mousedown,this)});if(this.isInline){this.picker.addClass("datepicker-inline");}else{this.picker.addClass("datepicker-dropdown dropdown-menu");}if(this.isRTL){this.picker.addClass("datepicker-rtl");this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right");}$(document).on("mousedown",function(e){if($(e.target).closest(".datepicker.datepicker-inline, .datepicker.datepicker-dropdown").length===0){that.hide();}});this.autoclose=false;if("autoclose" in options){this.autoclose=options.autoclose;}else{if("dateAutoclose" in this.element.data()){this.autoclose=this.element.data("date-autoclose");}}this.keyboardNavigation=true;if("keyboardNavigation" in options){this.keyboardNavigation=options.keyboardNavigation;}else{if("dateKeyboardNavigation" in this.element.data()){this.keyboardNavigation=this.element.data("date-keyboard-navigation");}}this.viewMode=this.startViewMode=0;switch(options.startView||this.element.data("date-start-view")){case 2:case"decade":this.viewMode=this.startViewMode=2;break;case 1:case"year":this.viewMode=this.startViewMode=1;break;}this.minViewMode=options.minViewMode||this.element.data("date-min-view-mode")||0;if(typeof this.minViewMode==="string"){switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0;break;}}this.viewMode=this.startViewMode=Math.max(this.startViewMode,this.minViewMode);this.todayBtn=(options.todayBtn||this.element.data("date-today-btn")||false);this.todayHighlight=(options.todayHighlight||this.element.data("date-today-highlight")||false);this.calendarWeeks=false;if("calendarWeeks" in options){this.calendarWeeks=options.calendarWeeks;}else{if("dateCalendarWeeks" in this.element.data()){this.calendarWeeks=this.element.data("date-calendar-weeks");}}if(this.calendarWeeks){this.picker.find("tfoot th.today").attr("colspan",function(i,val){return parseInt(val)+1;});}this.weekStart=((options.weekStart||this.element.data("date-weekstart")||dates[this.language].weekStart||0)%7);this.weekEnd=((this.weekStart+6)%7);this.startDate=-Infinity;this.endDate=Infinity;this.daysOfWeekDisabled=[];this.setStartDate(options.startDate||this.element.data("date-startdate"));this.setEndDate(options.endDate||this.element.data("date-enddate"));this.setDaysOfWeekDisabled(options.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled"));this.fillDow();this.fillMonths();this.update();this.showMode();if(this.isInline){this.show();}};Datepicker.prototype={constructor:Datepicker,_events:[],_attachEvents:function(){this._detachEvents();if(this.isInput){this._events=[[this.element,{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}]];}else{if(this.component&&this.hasInput){this._events=[[this.element.find("input"),{focus:$.proxy(this.show,this),keyup:$.proxy(this.update,this),keydown:$.proxy(this.keydown,this)}],[this.component,{click:$.proxy(this.show,this)}]];}else{if(this.element.is("div")){this.isInline=true;}else{this._events=[[this.element,{click:$.proxy(this.show,this)}]];}}}for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];el.on(ev);}},_detachEvents:function(){for(var i=0,el,ev;i<this._events.length;i++){el=this._events[i][0];ev=this._events[i][1];el.off(ev);}this._events=[];},show:function(e){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.update();this.place();$(window).on("resize",$.proxy(this.place,this));if(e){e.stopPropagation();e.preventDefault();}this.element.trigger({type:"show",date:this.date});},hide:function(e){if(this.isInline){return;}if(!this.picker.is(":visible")){return;}this.picker.hide();$(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){$(document).off("mousedown",this.hide);}if(this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())){this.setValue();}this.element.trigger({type:"hide",date:this.date});},remove:function(){this._detachEvents();this.picker.remove();delete this.element.data().datepicker;},getDate:function(){var d=this.getUTCDate();return new Date(d.getTime()+(d.getTimezoneOffset()*60000));},getUTCDate:function(){return this.date;},setDate:function(d){this.setUTCDate(new Date(d.getTime()-(d.getTimezoneOffset()*60000)));},setUTCDate:function(d){this.date=d;this.setValue();},setValue:function(){var formatted=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find("input").val(formatted);}this.element.data("date",formatted);}else{this.element.val(formatted);}},getFormattedDate:function(format){if(format===undefined){format=this.format;}return DPGlobal.formatDate(this.date,format,this.language);},setStartDate:function(startDate){this.startDate=startDate||-Infinity;if(this.startDate!==-Infinity){this.startDate=DPGlobal.parseDate(this.startDate,this.format,this.language);}this.update();this.updateNavArrows();},setEndDate:function(endDate){this.endDate=endDate||Infinity;if(this.endDate!==Infinity){this.endDate=DPGlobal.parseDate(this.endDate,this.format,this.language);}this.update();this.updateNavArrows();},setDaysOfWeekDisabled:function(daysOfWeekDisabled){this.daysOfWeekDisabled=daysOfWeekDisabled||[];if(!$.isArray(this.daysOfWeekDisabled)){this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/);}this.daysOfWeekDisabled=$.map(this.daysOfWeekDisabled,function(d){return parseInt(d,10);});this.update();this.updateNavArrows();},place:function(){if(this.isInline){return;}var zIndex=parseInt(this.element.parents().filter(function(){return $(this).css("z-index")!="auto";}).first().css("z-index"))+10;var offset=this.component?this.component.offset():this.element.offset();var height=this.component?this.component.outerHeight(true):this.element.outerHeight(true);this.picker.css({top:offset.top+height,left:offset.left,zIndex:zIndex});},update:function(){var date,fromArgs=false;if(arguments&&arguments.length&&(typeof arguments[0]==="string"||arguments[0] instanceof Date)){date=arguments[0];fromArgs=true;}else{date=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val();}this.date=DPGlobal.parseDate(date,this.format,this.language);if(fromArgs){this.setValue();}if(this.date<this.startDate){this.viewDate=new Date(this.startDate);}else{if(this.date>this.endDate){this.viewDate=new Date(this.endDate);}else{this.viewDate=new Date(this.date);}}this.fill();},fillDow:function(){var dowCnt=this.weekStart,html="<tr>";if(this.calendarWeeks){var cell='<th class="cw">&nbsp;</th>';html+=cell;this.picker.find(".datepicker-days thead tr:first-child").prepend(cell);}while(dowCnt<this.weekStart+7){html+='<th class="dow">'+dates[this.language].daysMin[(dowCnt++)%7]+"</th>";}html+="</tr>";this.picker.find(".datepicker-days thead").append(html);},fillMonths:function(){var html="",i=0;while(i<12){html+='<span class="month">'+dates[this.language].monthsShort[i++]+"</span>";}this.picker.find(".datepicker-months td").html(html);},fill:function(){var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth(),startYear=this.startDate!==-Infinity?this.startDate.getUTCFullYear():-Infinity,startMonth=this.startDate!==-Infinity?this.startDate.getUTCMonth():-Infinity,endYear=this.endDate!==Infinity?this.endDate.getUTCFullYear():Infinity,endMonth=this.endDate!==Infinity?this.endDate.getUTCMonth():Infinity,currentDate=this.date&&this.date.valueOf(),today=new Date();this.picker.find(".datepicker-days thead th.switch").text(dates[this.language].months[month]+" "+year);this.picker.find("tfoot th.today").text(dates[this.language].today).toggle(this.todayBtn!==false);this.updateNavArrows();this.fillMonths();var prevMonth=UTCDate(year,month-1,28,0,0,0,0),day=DPGlobal.getDaysInMonth(prevMonth.getUTCFullYear(),prevMonth.getUTCMonth());prevMonth.setUTCDate(day);prevMonth.setUTCDate(day-(prevMonth.getUTCDay()-this.weekStart+7)%7);var nextMonth=new Date(prevMonth);nextMonth.setUTCDate(nextMonth.getUTCDate()+42);nextMonth=nextMonth.valueOf();var html=[];var clsName;while(prevMonth.valueOf()<nextMonth){if(prevMonth.getUTCDay()==this.weekStart){html.push("<tr>");if(this.calendarWeeks){var ws=new Date(+prevMonth+(this.weekStart-prevMonth.getUTCDay()-7)%7*86400000),th=new Date(+ws+(7+4-ws.getUTCDay())%7*86400000),yth=new Date(+(yth=UTCDate(th.getUTCFullYear(),0,1))+(7+4-yth.getUTCDay())%7*86400000),calWeek=(th-yth)/86400000/7+1;html.push('<td class="cw">'+calWeek+"</td>");}}clsName="";if(prevMonth.getUTCFullYear()<year||(prevMonth.getUTCFullYear()==year&&prevMonth.getUTCMonth()<month)){clsName+=" old";}else{if(prevMonth.getUTCFullYear()>year||(prevMonth.getUTCFullYear()==year&&prevMonth.getUTCMonth()>month)){clsName+=" new";}}if(this.todayHighlight&&prevMonth.getUTCFullYear()==today.getFullYear()&&prevMonth.getUTCMonth()==today.getMonth()&&prevMonth.getUTCDate()==today.getDate()){clsName+=" today";}if(currentDate&&prevMonth.valueOf()==currentDate){clsName+=" active";}if(prevMonth.valueOf()<this.startDate||prevMonth.valueOf()>this.endDate||$.inArray(prevMonth.getUTCDay(),this.daysOfWeekDisabled)!==-1){clsName+=" disabled";}html.push('<td class="day'+clsName+'">'+prevMonth.getUTCDate()+"</td>");if(prevMonth.getUTCDay()==this.weekEnd){html.push("</tr>");}prevMonth.setUTCDate(prevMonth.getUTCDate()+1);}this.picker.find(".datepicker-days tbody").empty().append(html.join(""));var currentYear=this.date&&this.date.getUTCFullYear();var months=this.picker.find(".datepicker-months").find("th:eq(1)").text(year).end().find("span").removeClass("active");if(currentYear&&currentYear==year){months.eq(this.date.getUTCMonth()).addClass("active");}if(year<startYear||year>endYear){months.addClass("disabled");}if(year==startYear){months.slice(0,startMonth).addClass("disabled");}if(year==endYear){months.slice(endMonth+1).addClass("disabled");}html="";year=parseInt(year/10,10)*10;var yearCont=this.picker.find(".datepicker-years").find("th:eq(1)").text(year+"-"+(year+9)).end().find("td");year-=1;for(var i=-1;i<11;i++){html+='<span class="year'+(i==-1||i==10?" old":"")+(currentYear==year?" active":"")+(year<startYear||year>endYear?" disabled":"")+'">'+year+"</span>";year+=1;}yearCont.html(html);},updateNavArrows:function(){var d=new Date(this.viewDate),year=d.getUTCFullYear(),month=d.getUTCMonth();switch(this.viewMode){case 0:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()&&month<=this.startDate.getUTCMonth()){this.picker.find(".prev").css({visibility:"hidden"});}else{this.picker.find(".prev").css({visibility:"visible"});}if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()&&month>=this.endDate.getUTCMonth()){this.picker.find(".next").css({visibility:"hidden"});}else{this.picker.find(".next").css({visibility:"visible"});}break;case 1:case 2:if(this.startDate!==-Infinity&&year<=this.startDate.getUTCFullYear()){this.picker.find(".prev").css({visibility:"hidden"});}else{this.picker.find(".prev").css({visibility:"visible"});}if(this.endDate!==Infinity&&year>=this.endDate.getUTCFullYear()){this.picker.find(".next").css({visibility:"hidden"});}else{this.picker.find(".next").css({visibility:"visible"});}break;}},click:function(e){e.stopPropagation();e.preventDefault();var target=$(e.target).closest("span, td, th");if(target.length==1){switch(target[0].nodeName.toLowerCase()){case"th":switch(target[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var dir=DPGlobal.modes[this.viewMode].navStep*(target[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,dir);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,dir);break;}this.fill();break;case"today":var date=new Date();date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);this.showMode(-2);var which=this.todayBtn=="linked"?null:"view";this._setDate(date,which);break;}break;case"span":if(!target.is(".disabled")){this.viewDate.setUTCDate(1);if(target.is(".month")){var day=1;var month=target.parent().find("span").index(target);var year=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(month);this.element.trigger({type:"changeMonth",date:this.viewDate});if(this.minViewMode==1){this._setDate(UTCDate(year,month,day,0,0,0,0));}}else{var year=parseInt(target.text(),10)||0;var day=1;var month=0;this.viewDate.setUTCFullYear(year);this.element.trigger({type:"changeYear",date:this.viewDate});if(this.minViewMode==2){this._setDate(UTCDate(year,month,day,0,0,0,0));}}this.showMode(-1);this.fill();}break;case"td":if(target.is(".day")&&!target.is(".disabled")){var day=parseInt(target.text(),10)||1;var year=this.viewDate.getUTCFullYear(),month=this.viewDate.getUTCMonth();if(target.is(".old")){if(month===0){month=11;year-=1;}else{month-=1;}}else{if(target.is(".new")){if(month==11){month=0;year+=1;}else{month+=1;}}}this._setDate(UTCDate(year,month,day,0,0,0,0));}break;}}},_setDate:function(date,which){if(!which||which=="date"){this.date=date;}if(!which||which=="view"){this.viewDate=date;}this.fill();this.setValue();this.element.trigger({type:"changeDate",date:this.date});var element;if(this.isInput){element=this.element;}else{if(this.component){element=this.element.find("input");}}if(element){element.change();if(this.autoclose&&(!which||which=="date")){this.hide();}}},moveMonth:function(date,dir){if(!dir){return date;}var new_date=new Date(date.valueOf()),day=new_date.getUTCDate(),month=new_date.getUTCMonth(),mag=Math.abs(dir),new_month,test;dir=dir>0?1:-1;if(mag==1){test=dir==-1?function(){return new_date.getUTCMonth()==month;}:function(){return new_date.getUTCMonth()!=new_month;};new_month=month+dir;new_date.setUTCMonth(new_month);if(new_month<0||new_month>11){new_month=(new_month+12)%12;}}else{for(var i=0;i<mag;i++){new_date=this.moveMonth(new_date,dir);}new_month=new_date.getUTCMonth();new_date.setUTCDate(day);test=function(){return new_month!=new_date.getUTCMonth();};}while(test()){new_date.setUTCDate(--day);new_date.setUTCMonth(new_month);}return new_date;},moveYear:function(date,dir){return this.moveMonth(date,dir*12);},dateWithinRange:function(date){return date>=this.startDate&&date<=this.endDate;},keydown:function(e){if(this.picker.is(":not(:visible)")){if(e.keyCode==27){this.show();}return;}var dateChanged=false,dir,day,month,newDate,newViewDate;switch(e.keyCode){case 27:this.hide();e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation){break;}dir=e.keyCode==37?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir);}else{if(e.shiftKey){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir);}else{newDate=new Date(this.date);newDate.setUTCDate(this.date.getUTCDate()+dir);newViewDate=new Date(this.viewDate);newViewDate.setUTCDate(this.viewDate.getUTCDate()+dir);}}if(this.dateWithinRange(newDate)){this.date=newDate;this.viewDate=newViewDate;this.setValue();this.update();e.preventDefault();dateChanged=true;}break;case 38:case 40:if(!this.keyboardNavigation){break;}dir=e.keyCode==38?-1:1;if(e.ctrlKey){newDate=this.moveYear(this.date,dir);newViewDate=this.moveYear(this.viewDate,dir);}else{if(e.shiftKey){newDate=this.moveMonth(this.date,dir);newViewDate=this.moveMonth(this.viewDate,dir);}else{newDate=new Date(this.date);newDate.setUTCDate(this.date.getUTCDate()+dir*7);newViewDate=new Date(this.viewDate);newViewDate.setUTCDate(this.viewDate.getUTCDate()+dir*7);}}if(this.dateWithinRange(newDate)){this.date=newDate;this.viewDate=newViewDate;this.setValue();this.update();e.preventDefault();dateChanged=true;}break;case 13:this.hide();e.preventDefault();break;case 9:this.hide();break;}if(dateChanged){this.element.trigger({type:"changeDate",date:this.date});var element;if(this.isInput){element=this.element;}else{if(this.component){element=this.element.find("input");}}if(element){element.change();}}},showMode:function(dir){if(dir){this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+dir));}this.picker.find(">div").hide().filter(".datepicker-"+DPGlobal.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows();}};$.fn.datepicker=function(option){var args=Array.apply(null,arguments);args.shift();return this.each(function(){var $this=$(this),data=$this.data("datepicker"),options=typeof option=="object"&&option;if(!data){$this.data("datepicker",(data=new Datepicker(this,$.extend({},$.fn.datepicker.defaults,options))));}if(typeof option=="string"&&typeof data[option]=="function"){data[option].apply(data,args);}});};$.fn.datepicker.defaults={};$.fn.datepicker.Constructor=Datepicker;var dates=$.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today"}};var DPGlobal={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(year){return(((year%4===0)&&(year%100!==0))||(year%400===0));},getDaysInMonth:function(year,month){return[31,(DPGlobal.isLeapYear(year)?29:28),31,30,31,30,31,31,30,31,30,31][month];},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(format){var separators=format.replace(this.validParts,"\0").split("\0"),parts=format.match(this.validParts);if(!separators||!separators.length||!parts||parts.length===0){throw new Error("Invalid date format.");}return{separators:separators,parts:parts};},parseDate:function(date,format,language){if(date instanceof Date){return date;}if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(date)){var part_re=/([\-+]\d+)([dmwy])/,parts=date.match(/([\-+]\d+)([dmwy])/g),part,dir;date=new Date();for(var i=0;i<parts.length;i++){part=part_re.exec(parts[i]);dir=parseInt(part[1]);switch(part[2]){case"d":date.setUTCDate(date.getUTCDate()+dir);break;case"m":date=Datepicker.prototype.moveMonth.call(Datepicker.prototype,date,dir);break;case"w":date.setUTCDate(date.getUTCDate()+dir*7);break;case"y":date=Datepicker.prototype.moveYear.call(Datepicker.prototype,date,dir);break;}}return UTCDate(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),0,0,0);}var parts=date&&date.match(this.nonpunctuation)||[],date=new Date(),parsed={},setters_order=["yyyy","yy","M","MM","m","mm","d","dd"],setters_map={yyyy:function(d,v){return d.setUTCFullYear(v);},yy:function(d,v){return d.setUTCFullYear(2000+v);},m:function(d,v){v-=1;while(v<0){v+=12;}v%=12;d.setUTCMonth(v);while(d.getUTCMonth()!=v){d.setUTCDate(d.getUTCDate()-1);}return d;},d:function(d,v){return d.setUTCDate(v);}},val,filtered,part;setters_map.M=setters_map.MM=setters_map.mm=setters_map.m;setters_map.dd=setters_map.d;date=UTCDate(date.getFullYear(),date.getMonth(),date.getDate(),0,0,0);var fparts=format.parts.slice();if(parts.length!=fparts.length){fparts=$(fparts).filter(function(i,p){return $.inArray(p,setters_order)!==-1;}).toArray();}if(parts.length==fparts.length){for(var i=0,cnt=fparts.length;i<cnt;i++){val=parseInt(parts[i],10);part=fparts[i];if(isNaN(val)){switch(part){case"MM":filtered=$(dates[language].months).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p;});val=$.inArray(filtered[0],dates[language].months)+1;break;case"M":filtered=$(dates[language].monthsShort).filter(function(){var m=this.slice(0,parts[i].length),p=parts[i].slice(0,m.length);return m==p;});val=$.inArray(filtered[0],dates[language].monthsShort)+1;break;}}parsed[part]=val;}for(var i=0,s;i<setters_order.length;i++){s=setters_order[i];if(s in parsed&&!isNaN(parsed[s])){setters_map[s](date,parsed[s]);}}}return date;},formatDate:function(date,format,language){var val={d:date.getUTCDate(),D:dates[language].daysShort[date.getUTCDay()],DD:dates[language].days[date.getUTCDay()],m:date.getUTCMonth()+1,M:dates[language].monthsShort[date.getUTCMonth()],MM:dates[language].months[date.getUTCMonth()],yy:date.getUTCFullYear().toString().substring(2),yyyy:date.getUTCFullYear()};val.dd=(val.d<10?"0":"")+val.d;val.mm=(val.m<10?"0":"")+val.m;var date=[],seps=$.extend([],format.separators);for(var i=0,cnt=format.parts.length;i<cnt;i++){if(seps.length){date.push(seps.shift());}date.push(val[format.parts[i]]);}return date.join("");},headTemplate:'<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>'};DPGlobal.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+DPGlobal.headTemplate+"<tbody></tbody>"+DPGlobal.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+DPGlobal.headTemplate+DPGlobal.contTemplate+DPGlobal.footTemplate+"</table></div></div>";$.fn.datepicker.DPGlobal=DPGlobal;}(window.jQuery);(function($){var Constructor=function(options){this.init("typeahead",options,Constructor.defaults);this.options.typeahead=$.extend({},Constructor.defaults.typeahead,{matcher:this.matcher,sorter:this.sorter,highlighter:this.highlighter,updater:this.updater},options.typeahead);};$.fn.editableutils.inherit(Constructor,$.fn.editabletypes.list);$.extend(Constructor.prototype,{renderList:function(){this.$input=this.$tpl.is("input")?this.$tpl:this.$tpl.find('input[type="text"]');this.options.typeahead.source=this.sourceData;this.$input.typeahead(this.options.typeahead);var ta=this.$input.data("typeahead");ta.render=$.proxy(this.typeaheadRender,ta);ta.select=$.proxy(this.typeaheadSelect,ta);ta.move=$.proxy(this.typeaheadMove,ta);this.renderClear();this.setClass();this.setAttr("placeholder");},value2htmlFinal:function(value,element){if(this.getIsObjects()){var items=$.fn.editableutils.itemsByValue(value,this.sourceData);$(element).text(items.length?items[0].text:"");}else{$(element).text(value);}},html2value:function(html){return html?html:null;},value2input:function(value){if(this.getIsObjects()){var items=$.fn.editableutils.itemsByValue(value,this.sourceData);this.$input.data("value",value).val(items.length?items[0].text:"");}else{this.$input.val(value);}},input2value:function(){if(this.getIsObjects()){var value=this.$input.data("value"),items=$.fn.editableutils.itemsByValue(value,this.sourceData);if(items.length&&items[0].text.toLowerCase()===this.$input.val().toLowerCase()){return value;}else{return null;}}else{return this.$input.val();}},getIsObjects:function(){if(this.isObjects===undefined){this.isObjects=false;for(var i=0;i<this.sourceData.length;i++){if(this.sourceData[i].value!==this.sourceData[i].text){this.isObjects=true;break;}}}return this.isObjects;},activate:$.fn.editabletypes.text.prototype.activate,renderClear:$.fn.editabletypes.text.prototype.renderClear,postrender:$.fn.editabletypes.text.prototype.postrender,toggleClear:$.fn.editabletypes.text.prototype.toggleClear,clear:function(){$.fn.editabletypes.text.prototype.clear.call(this);this.$input.data("value","");},matcher:function(item){return $.fn.typeahead.Constructor.prototype.matcher.call(this,item.text);},sorter:function(items){var beginswith=[],caseSensitive=[],caseInsensitive=[],item,text;while(item=items.shift()){text=item.text;if(!text.toLowerCase().indexOf(this.query.toLowerCase())){beginswith.push(item);}else{if(~text.indexOf(this.query)){caseSensitive.push(item);}else{caseInsensitive.push(item);}}}return beginswith.concat(caseSensitive,caseInsensitive);},highlighter:function(item){return $.fn.typeahead.Constructor.prototype.highlighter.call(this,item.text);},updater:function(item){this.$element.data("value",item.value);return item.text;},typeaheadRender:function(items){var that=this;items=$(items).map(function(i,item){i=$(that.options.item).data("item",item);i.find("a").html(that.highlighter(item));return i[0];});if(this.options.autoSelect){items.first().addClass("active");}this.$menu.html(items);return this;},typeaheadSelect:function(){var val=this.$menu.find(".active").data("item");if(this.options.autoSelect||val){this.$element.val(this.updater(val)).change();}return this.hide();},typeaheadMove:function(e){if(!this.shown){return;}switch(e.keyCode){case 9:case 13:case 27:if(!this.$menu.find(".active").length){return;}e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break;}e.stopPropagation();}});Constructor.defaults=$.extend({},$.fn.editabletypes.list.defaults,{tpl:'<input type="text">',typeahead:null,clear:true});$.fn.editabletypes.typeahead=Constructor;}(window.jQuery));